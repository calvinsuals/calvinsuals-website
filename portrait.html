<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人像项目 - calvinsuals</title>
    <!-- 字体 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400&family=Montserrat:wght@300;400;500;700&family=Raleway:wght@300;400&family=Open+Sans:wght@300;400&family=Roboto:wght@300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500&family=M+PLUS+Rounded+1c:wght@400;500&family=Varela+Round&family=Quicksand:wght@400;500&family=Comfortaa:wght@400;500&display=swap" rel="stylesheet">
    <!-- 样式 -->
    <!-- <link rel="stylesheet" href="navigation.css"> -->
    <!-- <link rel="stylesheet" href="footer.css"> -->
    <!-- <link rel="stylesheet" href="titles.css"> -->
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <!-- <link rel="stylesheet" href="gallery.css"> -->
    <link rel="stylesheet" href="portrait.css">
    <style>
        /* --- Global Reset & Base --- */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
            background-color: #a89b8d;
            color: #ffffff;
            width: 100%; /* Prevent default horizontal scrollbar */
            overflow-x: hidden; /* Prevent body scroll globally */
        }

        body {
            overflow-x: hidden;
        }

        body.portrait-page {
            background-color: #a89b8d;
        }
        
        .projects-page {
            padding: 0;
            margin: 0;
            position: relative;
        }

        /* 删除旧的 section-title 样式 */
        /*
        .section-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5em;
            font-weight: 700;
            color: #ffffff; 
            position: absolute; 
            top: 40px;          
            left: 40px;         
            z-index: 10; 
        }

        .section-title::before {
            content: 'PROJECTS'; 
            position: absolute;
            left: 0;
            top: 0;
            right: 0; 
            bottom: 0;
            z-index: 9; 
            text-shadow:
                -8px -8px 0 rgba(255, 255, 255, 0.6),
                8px -8px 0 rgba(255, 255, 255, 0.6),
                -8px 8px 0 rgba(255, 255, 255, 0.6),
                8px 8px 0 rgba(255, 255, 255, 0.6),
                -12px 0px 0 rgba(255, 255, 255, 0.4),
                12px 0px 0 rgba(255, 255, 255, 0.4);
            color: transparent;
            font-family: inherit;
            font-size: inherit;
            font-weight: inherit;
            pointer-events: none;
        }
        */

        /* --- 删除旧的 Page Title (Portrait) 样式 --- */
        /*
        html body.portrait-page .page-title-container .page-title {
            font-size: 2em !important; 
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            position: relative;
            margin: 150px 0 40px 40px;
            text-transform: uppercase;
            letter-spacing: 2px;
            z-index: 10;
            color: rgba(51, 51, 51, 0.85);
            display: flex;
            flex-direction: row;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .title-line {
            position: relative;
            display: inline-block;
            color: transparent; 
            margin-right: 15px; 
        }
        
        .title-line::before {
            content: attr(class);
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            z-index: 9;
            text-shadow:
                0 0 0 rgba(255, 255, 255, 0.8),
                -8px -8px 0 rgba(255, 255, 255, 0.6),
                8px -8px 0 rgba(255, 255, 255, 0.6),
                -8px 8px 0 rgba(255, 255, 255, 0.6),
                8px 8px 0 rgba(255, 255, 255, 0.6),
                -12px 0px 0 rgba(255, 255, 255, 0.4),
                12px 0px 0 rgba(255, 255, 255, 0.4);
            color: rgba(51, 51, 51, 0.85);
            font-family: inherit;
            font-size: inherit;
            font-weight: inherit;
            text-transform: inherit;
            letter-spacing: inherit;
            pointer-events: none;
        }
        
        .title-line::after {
            content: attr(class);
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            z-index: 9999;
            background: linear-gradient(
                70deg,
                rgba(40, 40, 40, 0.85) 0%,
                rgba(40, 40, 40, 0.85) 40%, 
                rgba(200, 200, 200, 0.9) 50%,
                rgba(40, 40, 40, 0.85) 60%,
                rgba(40, 40, 40, 0.85) 100%
            );
            background-size: 400% 400%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: flowing-text-light-wave 12s ease-in-out infinite;
            font-family: inherit;
            font-size: inherit;
            font-weight: inherit;
            text-transform: inherit;
            letter-spacing: inherit;
            pointer-events: none;
            text-shadow: none !important;
            -webkit-text-stroke: 0 transparent !important;
            mix-blend-mode: normal !important;
            filter: none !important;
            opacity: 1 !important;
        }
        
        .title-line:first-child::before,
        .title-line:first-child::after {
            content: "PORTRAIT";
        }
        
        .title-line:last-child::before,
        .title-line:last-child::after {
            content: "PROJECTS";
        }

        @keyframes flowing-text-light-wave {
            0% {
                background-position: 0% 30%; 
            }
            25% {
                background-position: 50% 0%; 
            }
            50% {
                background-position: 100% 70%; 
            }
            75% {
                background-position: 50% 100%; 
            }
            100% {
                background-position: 0% 30%; 
            }
        }
        */

        /* --- 删除手机端标题位置调整 --- */
        /*
        @media (max-width: 767px) {
             html body.portrait-page .page-title-container .page-title {
                flex-direction: column !important; 
                font-size: 1.4em !important; 
                margin-top: 100px; 
                width: 80%; 
                margin-left: 20px; 
                text-align: left; 
                padding-bottom: 5px; 
                margin-bottom: 10px; 
                align-items: flex-start; 
            }
        }
        */
        
        /* --- Portrait Gallery Container --- */
        .portrait-gallery-container {
            position: relative;
            width: 100%;
            margin-bottom: 80px;
            margin-top: 60px; /* 增加顶部间距 */
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.35),
                0 15px 30px rgba(0, 0, 0, 0.3),
                0 10px 20px rgba(0, 0, 0, 0.25);
            transition: box-shadow 0.3s ease;
            background-color: #242424; /* 更深的灰色，与标题区域形成对比 */
            padding: 20px 0;
            min-height: 300px; /* 为画廊设置最小高度 */
        }

        .portrait-gallery-container:hover {
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.4),
                0 20px 40px rgba(0, 0, 0, 0.35),
                0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .portrait-gallery-container::after {
            content: '';
            position: absolute;
            width: 120%;
            height: 1px;
            bottom: -45px;
            left: -10%;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 
                0 0 15px 2px rgba(255, 255, 255, 0.5),
                0 0 10px 1px rgba(255, 255, 255, 0.3),
                0 0 5px 1px rgba(255, 255, 255, 0.2);
            filter: blur(0.3px);
        }

        .portrait-gallery-container::before {
            content: '';
            position: absolute;
            width: 70%;
            height: 1px;
            bottom: -85px;
            left: 15%;
            background: linear-gradient(to right, transparent, rgba(255,255,255,0.2), transparent);
        }

        /* --- Gallery Grid & Items --- */
        .projects-grid {
            /* Ensure no rounded corners on the grid itself */
            border-radius: 0;
            /* Default: Mobile & PC layout (Flex Scroll) */
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;  /* Explicitly disable vertical scroll */
            gap: 0;           /* NO GAPS per requirement */
            padding: 0;       /* NO PADDING per requirement */
            margin: 0 auto;
            background-color: #242424; /* 与容器背景色匹配 */
            scroll-snap-type: x mandatory;
            padding-bottom: 20px;
            width: 100%;
            cursor: grab;
            user-select: none; /* Prevent text selection during drag */
            -webkit-user-select: none; /* Safari compatibility */
            /* Hide scrollbar for cleaner look */
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
            min-height: 260px; /* 为项目网格设置最小高度 */
        }

        .projects-grid::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        .project-item {
            transition: none !important; /* Force disable transitions on item container */
            /* Style for each item in the grid */
            border-radius: 0; /* Remove rounded corners */
            margin-right: 0; /* Remove any right margin if needed, gap handles spacing */
            /* Reset styles */
            position: relative; 
            overflow: visible; 
            /* Reset spacing & background */
            padding: 0;
            margin: 0;
            background-color: transparent; 
            /* Ensure items don't shrink in flex layout */
            flex: 0 0 auto; 
            flex-shrink: 0;
        }

        .project-item img {
            transition: none !important; /* Force disable transitions on image */
            display: block; 
            width: 300px;     /* FIXED Width for items in scroll */
            height: auto;     /* Height adjusts based on aspect ratio */
            border-radius: 0; /* Remove rounded corners from image itself */
        }

        .showcase-container {
            /* Structure & Base Style */
            margin: 0 auto;
            position: relative;
            /* Removed box-shadow and transitions */
        }

        /* --- Desktop Layout --- */
        @media (min-width: 1200px) {
            .showcase-container {
                width: 1200px; /* Match automotive */
                margin-left: auto;
                margin-right: auto;
            }
            /* Assuming .car-gallery is the scroll container inside .showcase-container */
            #gallery-sections-container .car-gallery { 
                width: 1200px; /* Match container width */
            }
            .showcase-section {
                text-align: center;
                padding: 40px 100px; /* Horizontal padding */
                margin-top: 80px; /* INCREASED top margin (match automotive) */
                padding-top: 0; /* 移除上内边距 */
                margin-bottom: 10vh; /* 与全局设置保持一致 */
            }
            .project-item {
                flex: 0 0 auto;
            }
        }

        /* --- Tablet Layout --- */
        @media (min-width: 768px) and (max-width: 1280px) {
            .showcase-container {
                width: 90%; /* Reduced container width */
                margin-left: auto;
                margin-right: auto;
            }
            .projects-grid { /* Target the grid container */
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                width: 100%;
                overflow-x: hidden;
            }
            .project-item { /* Target grid item */
                width: 100%;
                padding: 0; /* Remove internal padding */
            }
            .project-item img { /* Target image */
                display: block;
                width: 100%;
                height: auto;
                border-radius: 4px;
                object-fit: cover;
            }
            .showcase-section {
                padding: 50px 5%; /* Slightly increase side padding */
            }
        }

        /* --- Mobile Layout (Slider) --- */
        @media (max-width: 767px) {
            .showcase-container {
                width: 90%; /* Reduced container width */
                margin-left: auto;
                margin-right: auto;
            }
            .projects-grid { /* Target the flex container */
                display: flex;
                overflow-x: auto;
                gap: 0;
                width: 100%;
                scroll-snap-type: x mandatory;
            }
            .project-item { /* Target flex item */
                 width: 100%;
                 flex-shrink: 0;
                 scroll-snap-align: center;
                 padding: 0; /* Remove internal padding */
             }
             .project-item img { /* Target image */
                 display: block;
                 width: 100%;
                 height: auto;
                 border-radius: 4px;
                 object-fit: cover;
            }
            .showcase-section {
                padding: 0 5% 20px 5%; /* Add side padding back */
            }
        }

        /* --- Navigation Menu CSS --- */
        
        .main-nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
        }
        
        .nav-container {
            position: relative;
        }
        
        .menu-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            padding: 10px 5px;
            background-color: transparent;
        }
        
        .menu-toggle span {
            display: block;
            width: 100%;
            height: 2px;
            background-color: white;
            transition: all 0.3s;
        }
        
        .menu-toggle.active span:nth-child(1) {
            transform: translateY(8px) rotate(45deg);
        }
        
        .menu-toggle.active span:nth-child(2) {
            opacity: 0;
        }
        
        .menu-toggle.active span:nth-child(3) {
            transform: translateY(-8px) rotate(-45deg);
        }
        
        .menu-content {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            transform: translateY(-100%);
            transition: transform 0.4s cubic-bezier(0.645, 0.045, 0.355, 1);
            visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .menu-content.active {
            transform: translateY(0);
            visibility: visible;
        }
        
        .menu-items {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: auto;
            width: 100%;
            max-width: 400px;
        }
        
        .menu-items a {
            color: white;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            text-decoration: none;
            padding: 15px 0;
            margin: 5px 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            transition: transform 0.3s ease;
            text-align: center;
            width: 100%;
            box-sizing: border-box;
        }
        
        .menu-items a:hover {
            transform: translateY(-3px);
        }
        
        .menu-items a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: white;
            transition: width 0.3s ease;
        }
        
        .menu-items a:hover::after {
            width: 60%;
            left: 50%;
            transform: translateX(-50%);
        }
        
        /* 电脑端菜单样式 */
        @media screen and (min-width: 1024px) {
            .menu-toggle {
                position: fixed;
                top: 20px;
                right: 20px;
                width: 40px;
                height: 40px;
                z-index: 1001;
            }
            
            .menu-content {
                width: 100vw;
                left: 50%;
                transform: translateY(-100%) translateX(-50%);
                margin-left: 0;
                display: flex !important;
                justify-content: center !important;
                align-items: center !important;
            }
            
            .menu-content.active {
                transform: translateY(0) translateX(-50%);
            }
            
            .menu-items {
                margin: 0 auto;
                padding: 0;
                width: 100%;
                max-width: 400px;
                position: relative;
                transform: translateX(0);
                left: 0;
                right: 0;
            }
            
            .menu-items a {
                text-align: center;
                width: 100%;
                padding: 15px 0;
                margin: 5px 0;
                font-size: 1.5rem;
            }
        }
        
        /* 移动端菜单样式 */
        @media screen and (max-width: 767px) {
            .menu-toggle {
                top: 15px;
                right: 15px;
                width: 35px;
                height: 35px;
            }
            
            .menu-content {
                width: 100% !important;
                left: 0 !important;
                margin-left: 0 !important;
                height: 100%;
                display: flex !important;
                justify-content: center !important;
                align-items: center !important;
            }
            
            .menu-items {
                height: auto !important;
                max-width: 300px !important;
            }
            
            .menu-items a {
                font-size: 1.2rem;
                padding: 12px 0;
                margin: 8px 0;
            }
        }
        
        #gallery-sections-container {
            margin-top: 0; /* REMOVED top margin for spacing below header for seamless connection */
        }

        .showcase-section {
            margin-bottom: 10vh; /* 底部间距从30vh减小到10vh */
            position: relative;
            margin-top: 30px; /* 增加顶部间距 */
        }
        
        /* 调整页脚样式与主页保持一致 */
        .footer {
            position: static;
            background-color: #e8e6e1; /* 修改为与渐变底部颜色完全一致 */
            color: rgba(0, 0, 0, 0.7); /* 修改为深色文字，以适应浅色背景 */
            text-align: center;
            padding: 15px 0;
            width: 100%;
            max-width: 1800px;
            margin: 0 auto;
        }

        .footer p {
            margin: 0;
            font-size: 0.9rem;
            font-family: 'Montserrat', sans-serif; /* 确保使用与主页相同的字体 */
        }

        @media (max-width: 767px) {
            .footer {
                padding: 15px 0;
                width: 100%;
            }
            
            .footer p {
                font-size: 0.8rem;
            }
        }
        
        /* REMOVED background and shadow from title container for seamless connection */
        .page-title-container {
            /* background-color: rgba(138, 126, 113, 0.6); */
            padding: 15px 0;
            width: 100%;
            /* box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); */
            display: block;
            margin: 0;
            border-radius: 0;
        }
        
        .page-title {
            margin-top: 120px; /* 保持原有的上边距 */
            font-size: 1.5em;
            margin-left: 40px;
            display: flex;
            flex-direction: row;
            align-items: center;
            flex-wrap: wrap;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        /* 画廊占位符样式 */
        .gallery-placeholder {
            width: 100%;
            min-height: 260px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgba(255, 255, 255, 0.6);
            font-style: italic;
            font-size: 1.1em;
            text-align: center;
            padding: 20px;
        }

        /* 平板端样式 (768px - 1280px) */
        @media screen and (min-width: 768px) and (max-width: 1280px) {
            .gallery-container {
                display: grid;
                grid-template-columns: repeat(2, 1fr); /* 两列布局 */
                gap: 20px;
                padding: 0 30px;
                width: 600px; /* 固定宽度为600px */
                margin: 0 auto;
            }

            .gallery-item {
                width: 100%;
                margin-bottom: 0;
            }

            .gallery-item img {
                width: 100%;
                height: auto;
                border-radius: 8px;
                transition: transform 0.3s ease;
            }

            .section-title {
                margin-left: 30px;
                margin-bottom: 30px;
            }

            /* 调整画廊容器宽度 */
            .showcase-container {
                width: 600px !important;
                margin-left: auto;
                margin-right: auto;
            }

            /* 调整图片容器宽度 */
            .car-gallery {
                width: 600px !important;
            }

            /* 调整单个图片尺寸 */
            .car-gallery img {
                width: 290px !important; /* 考虑到间距，每张图片290px */
                height: auto;
            }
        }

        /* 桌面端样式 */
        @media screen and (min-width: 1281px) {
            .gallery-container {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 30px;
                padding: 0 40px;
                max-width: 1800px;
                margin: 0 auto;
            }
        }
    </style>
</head>
<body class="portrait-page">
    <!-- 导航菜单 -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="menu-content">
                <div class="menu-items">
                    <a href="index.html">HOME</a>
                    <a href="automotive.html">AUTOMOTIVE</a>
                    <a href="portrait.html" class="active">PORTRAIT</a>
                    <a href="pricing.html">PRICING</a>
                    <a href="index.html#about">ABOUT</a>
                    <a href="index.html#contact">CONTACT</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- 页面标题 -->
    <div class="title-background">
        <h1 class="title-text">Portrait Projects</h1>
    </div>

    <!-- Main container for all gallery sections -->
    <div id="gallery-sections-container"></div>

    <!-- 页脚 -->
    <footer class="footer">
        <p>&copy; 2025 calvinsuals. All photography works and website content are copyrighted by the author.</p>
        <p>Website design and development: calvinsuals.</p>
    </footer>

    <script>
        // Revised Menu Control Code
        const menuToggle = document.querySelector('.menu-toggle'); // Use querySelector for class
        const menuContent = document.querySelector('.menu-content'); // Use querySelector for class

        if (menuToggle && menuContent) { // Check if elements exist
            menuToggle.addEventListener('click', () => {
                menuToggle.classList.toggle('active'); // Toggle active state on the button
                menuContent.classList.toggle('active'); // Toggle active state on the menu content
                // Optional: Add visibility control based on active class if CSS doesn't handle it
                 if (!menuContent.classList.contains('active')) {
                     // Small delay to allow animation before hiding completely
                     setTimeout(() => {
                         menuContent.style.visibility = 'hidden';
                     }, 400); // Match CSS transition duration if any
                 } else {
                     menuContent.style.visibility = 'visible';
                 }
            });

            // Optional: Close menu when a link is clicked
            const menuItems = document.querySelectorAll('.menu-items a');
            menuItems.forEach(item => {
                item.addEventListener('click', () => {
                    menuToggle.classList.remove('active');
                    menuContent.classList.remove('active');
                     setTimeout(() => {
                         menuContent.style.visibility = 'hidden';
                     }, 400);
                });
            });

        } else {
            console.error('Error: Menu toggle button (.menu-toggle) or menu content (.menu-content) not found.');
        }

        // --- 新的子画廊加载代码 (与 automotive 页面完全一致的结构) ---
        async function displaySubGalleries(galleryType) {
            const mainContainer = document.getElementById('gallery-sections-container');
            if (!mainContainer) {
                console.error('Error: Main container #gallery-sections-container not found.');
                    return;
                }
            mainContainer.innerHTML = ''; // 清空现有内容

            const basePath = `images/${galleryType}`; // e.g., images/portrait
            const mainGalleryListFile = `${basePath}/galleries.json`;

            console.log(`[${galleryType}] Loading main gallery list from: ${mainGalleryListFile}`);

            try {
                const response = await fetch(mainGalleryListFile);
                    if (!response.ok) { 
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const galleryList = await response.json();
                console.log(`[${galleryType}] Found ${galleryList.length} sub-galleries.`);

                if (galleryList.length === 0) {
                     mainContainer.innerHTML = '<p class="gallery-placeholder">暂无画廊数据。</p>';
                     return;
                }

                // 遍历主画廊列表中的每个子画廊定义
                for (const galleryInfo of galleryList) {
                    if (!galleryInfo.id || !galleryInfo.jsonFile) {
                        console.warn(`[${galleryType}] Skipping gallery entry due to missing id or jsonFile:`, galleryInfo);
                        continue;
                    }

                    const subGalleryId = galleryInfo.id;
                    const subGalleryTitle = galleryInfo.title || subGalleryId.replace('_', ' ');
                    const subGalleryPath = `${basePath}/${subGalleryId}`;
                    const subGalleryJsonPath = `${subGalleryPath}/${galleryInfo.jsonFile}`;

                    console.log(`[${galleryType}] Processing sub-gallery: ${subGalleryTitle} (Path: ${subGalleryPath}, JSON: ${subGalleryJsonPath})`);

                    try {
                        const response = await fetch(subGalleryJsonPath);
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);
                        }
                        const subGalleryDataArray = await response.json();
                        let subGalleryImages = [];
                        
                        if (Array.isArray(subGalleryDataArray) && subGalleryDataArray.length > 0) {
                            if (subGalleryDataArray[0] && Array.isArray(subGalleryDataArray[0].images)) {
                                subGalleryImages = subGalleryDataArray[0].images;
                                console.log(`[${galleryType}] Successfully parsed JSON for sub-gallery: ${subGalleryTitle}, found ${subGalleryImages.length} images.`);
                            } else {
                                console.warn(`[${galleryType}] JSON structure for ${subGalleryTitle} is incorrect. Missing 'images' array in the first object.`);
                            }
                        } else {
                             console.warn(`[${galleryType}] JSON data for ${subGalleryTitle} is not a valid array or is empty.`);
                        }

                        // --- 创建 HTML 结构 (使用 automotive.css 的类名) ---
                        if (subGalleryImages.length > 0) {
                            const showcaseSection = document.createElement('section');
                            showcaseSection.classList.add('showcase-section');
                            showcaseSection.id = `showcase-${subGalleryId}`;

                            // 1. showcase-container 包裹画廊
                            const showcaseContainer = document.createElement('div');
                            showcaseContainer.classList.add('showcase-container');
                            showcaseSection.appendChild(showcaseContainer);

                            // 2. gallery-background 用于发光条
                            const galleryBackground = document.createElement('div');
                            galleryBackground.classList.add('gallery-background');
                            showcaseContainer.appendChild(galleryBackground);

                            // 3. car-gallery-container 作为实际画廊背景和阴影
                            const galleryContainer = document.createElement('div');
                            galleryContainer.classList.add('car-gallery-container'); 
                            galleryContainer.id = `subgallery-${subGalleryId}`;
                            galleryBackground.appendChild(galleryContainer);

                            // 4. car-gallery 作为图片滚动容器
                            const imageScrollContainer = document.createElement('div');
                            imageScrollContainer.classList.add('car-gallery'); 
                            galleryContainer.appendChild(imageScrollContainer);

                            subGalleryImages.forEach((imageName, index) => {
                                if (typeof imageName !== 'string' || imageName.trim() === '') {
                                    console.warn(`[${galleryType} - ${subGalleryTitle}] Invalid image name found at index ${index}:`, imageName);
                                    return;
                                }
                                const imagePath = `${subGalleryPath}/${imageName}`;

                                // 直接创建 img 元素并添加到 car-gallery
                                const imgElement = document.createElement('img');
                                imgElement.src = imagePath;
                                imgElement.alt = `${subGalleryTitle} - Image ${index + 1}`;
                                imgElement.loading = 'lazy';

                                imgElement.onerror = () => {
                                    console.error(`[${galleryType} - ${subGalleryTitle}] Image failed to load: ${imagePath}`);
                                    imgElement.alt = `Failed to load ${imagePath}`;
                                    imgElement.style.display = 'none';
                                };
                                
                                imageScrollContainer.appendChild(imgElement);
                            });

                            mainContainer.appendChild(showcaseSection);
                            console.log(`[${galleryType}] Added AUTOMOTIVE styled section for sub-gallery: ${subGalleryTitle}`);
                            // *** 重新启用拖动滚动功能，目标是 .car-gallery ***
                            initializeDragScroll(imageScrollContainer); 
                        } else {
                            // --- 占位符逻辑 (也使用 automotive 结构) ---
                            console.log(`[${galleryType}] Skipping section for sub-gallery ${subGalleryTitle} as it has no images.`);
                             const showcaseSection = document.createElement('section');
                             showcaseSection.classList.add('showcase-section');
                             showcaseSection.id = `showcase-${subGalleryId}`;

                             const showcaseContainer = document.createElement('div');
                             showcaseContainer.classList.add('showcase-container');
                             showcaseSection.appendChild(showcaseContainer);
                            
                             const galleryBackground = document.createElement('div');
                             galleryBackground.classList.add('gallery-background');
                             showcaseContainer.appendChild(galleryBackground);

                             const galleryContainer = document.createElement('div');
                             galleryContainer.classList.add('car-gallery-container');
                             galleryBackground.appendChild(galleryContainer);

                             const placeholderText = document.createElement('p');
                             placeholderText.classList.add('gallery-placeholder'); 
                             placeholderText.textContent = '此画廊暂无图片。';
                             galleryContainer.appendChild(placeholderText);
                             mainContainer.appendChild(showcaseSection);
                        }
                         // --- HTML 结构创建结束 ---

                    } catch (error) {
                        console.error(`[${galleryType}] Error processing sub-gallery ${subGalleryTitle} (${subGalleryJsonPath}):`, error);
                    }
                }

                console.log(`[${galleryType}] Finished processing all sub-galleries.`);

            } catch (error) {
                console.error(`Error loading main gallery list ${mainGalleryListFile}:`, error);
                mainContainer.innerHTML = '<p class="gallery-placeholder">加载画廊列表时出错。请检查控制台获取详细信息。</p>';
            }
        }

        // --- 拖动滚动功能 (确保目标是 .car-gallery) ---
        function initializeDragScroll(element) { // element is now .car-gallery
            if (!element) return;
                    let isDown = false;
                    let startX;
                    let scrollLeft;

            // Mouse Down: Start dragging
            element.addEventListener('mousedown', (e) => {
                // 只响应左键点击
                        if (e.button !== 0) return; 
                        isDown = true;
                element.classList.add('active-drag');
                startX = e.pageX - element.offsetLeft;
                scrollLeft = element.scrollLeft;
                element.style.cursor = 'grabbing';
                element.style.userSelect = 'none';
                // 阻止浏览器默认的图片拖拽行为
                e.preventDefault(); 
            });

            // Mouse Leave: Stop dragging if mouse leaves the element while pressed
            element.addEventListener('mouseleave', () => {
                        if (!isDown) return;
                        isDown = false;
                element.classList.remove('active-drag');
                element.style.cursor = 'grab';
                element.style.removeProperty('user-select');
            });

            // *** Global Mouse Up: Stop dragging wherever the mouse is released ***
                    window.addEventListener('mouseup', (e) => { 
                        if (e.button !== 0) return; 
                if (!isDown) return;
                        isDown = false;
                if (element.classList.contains('active-drag')) {
                     element.classList.remove('active-drag');
                     element.style.cursor = 'grab';
                     element.style.removeProperty('user-select');
                 }
            });

            // Mouse Move: Perform scrolling only if dragging
            element.addEventListener('mousemove', (e) => {
                if (!isDown) return; 
                const x = e.pageX - element.offsetLeft;
                const walk = (x - startX) * 1; 
                element.scrollLeft = scrollLeft - walk;
            });

             // 初始设置 grab 光标
             element.style.cursor = 'grab';
        }

        // --- 页面加载时调用 ---
        document.addEventListener('DOMContentLoaded', () => {
            displaySubGalleries('portrait'); 
        });
    </script>
</body>
</html>